Жизненный цикл событий в **DOM API** (Document Object Model Application Programming Interface) описывает процесс, через который проходит событие (например, клик мыши, нажатие клавиши или прокрутка страницы) от момента его возникновения до завершения обработки. 

Этот процесс основан на модели событий DOM и включает три основные фазы: **захват (capturing)**, **цель (target)** и **всплытие (bubbling)**. Понимание жизненного цикла событий важно для эффективной работы с обработчиками событий, делегированием и управлением поведением веб-приложений.

В этом ответе я подробно объясню жизненный цикл событий DOM, опишу каждую фазу, приведу примеры кода и рассмотрю особенности, включая остановку распространения событий и кроссбраузерные аспекты.

---

### 1. Жизненный цикл событий DOM:

Когда в браузере происходит событие (например, пользователь кликает по элементу), оно проходит через следующие этапы:

1. **Фаза захвата (Capturing Phase)**:
   - Событие начинается с корневого узла документа (`document`) и движется вниз по дереву DOM к целевому элементу (тому, на котором произошло событие).
   - Обработчики, зарегистрированные с опцией `{ capture: true }` в методе `addEventListener`, срабатывают на этой фазе.
   - Эта фаза редко используется, но полезна для перехвата событий до их достижения цели, например, для логирования или предотвращения обработки.

2. **Фаза цели (Target Phase)**:
   - Событие достигает целевого элемента, на котором оно было инициировано (например, `<button>`, по которому кликнули).
   - Все обработчики, привязанные к этому элементу (независимо от того, зарегистрированы они для захвата или всплытия), срабатывают на этой фазе.
   - Это основная точка обработки события.

3. **Фаза всплытия (Bubbling Phase)**:
   - После обработки на целевом элементе событие "всплывает" вверх по дереву DOM, от целевого элемента к его родителям, вплоть до `document` и `window`.
   - Обработчики, зарегистрированные для фазы всплытия (по умолчанию или с `{ capture: false }`), срабатывают на этой фазе.
   - Большинство событий в DOM всплывают, за исключением некоторых, таких как `focus`, `blur` или `scroll`.

**Графическое представление**:
```
[window]
   ↓ (захват)
[document]
   ↓
[html]
   ↓
[body]
   ↓
[div]
   ↓
[button] (цель)
   ↑ (всплытие)
[div]
   ↑
[body]
   ↑
[html]
   ↑
[document]
   ↑
[window]
```

---

### 2. Как работает жизненный цикл событий

Рассмотрим пример HTML-структуры:

```html
<div id="grandparent">
  <div id="parent">
    <button id="child">Кликни меня</button>
  </div>
</div>
```

Когда пользователь кликает на `<button>`, событие `click` проходит через все три фазы. Давайте разберём это с помощью кода.

#### Пример: Полный жизненный цикл

```javascript
const grandparent = document.querySelector('#grandparent');
const parent = document.querySelector('#parent');
const child = document.querySelector('#child');

// Обработчики для фазы захвата
grandparent.addEventListener(
  'click',
  () => {
    console.log('Grandparent (захват)');
  },
  { capture: true }
);

parent.addEventListener(
  'click',
  () => {
    console.log('Parent (захват)');
  },
  { capture: true }
);

// Обработчик на целевом элементе
child.addEventListener('click', () => {
  console.log('Child (цель)');
});

// Обработчики для фазы всплытия
parent.addEventListener('click', () => {
  console.log('Parent (всплытие)');
});

grandparent.addEventListener('click', () => {
  console.log('Grandparent (всплытие)');
});
```

**Что происходит при клике на кнопку**:
1. **Фаза захвата**:
   - Событие начинается с `window`, движется к `document`, затем к `<html>`, `<body>`, `<div id="grandparent">` и `<div id="parent">`.
   - Срабатывают обработчики на `grandparent` и `parent` с `{ capture: true }`.

2. **Фаза цели**:
   - Событие достигает `<button id="child">`, и срабатывает его обработчик.

3. **Фаза всплытия**:
   - Событие возвращается вверх по дереву DOM, вызывая обработчики на `<div id="parent">` и `<div id="grandparent">` (для фазы всплытия).

**Вывод в консоль**:
```
Grandparent (захват)
Parent (захват)
Child (цель)
Parent (всплытие)
Grandparent (всплытие)
```

---

### 3. Управление жизненным циклом событий

#### 3.1. Остановка распространения событий
Вы можете остановить распространение события на любой фазе, чтобы предотвратить вызов других обработчиков. Для этого используются два метода:

- **`event.stopPropagation()`**:
  - Останавливает дальнейшее распространение события (вверх на фазе всплытия или вниз на фазе захвата).
  - Другие обработчики на текущем элементе всё равно сработают.

- **`event.stopImmediatePropagation()`**:
  - Останавливает распространение события и предотвращает выполнение других обработчиков на том же элементе.

**Пример с `stopPropagation`**:

```javascript
child.addEventListener('click', (event) => {
  console.log('Child (цель)');
  event.stopPropagation(); // Останавливаем всплытие
});

parent.addEventListener('click', () => {
  console.log('Parent (всплытие)'); // Не сработает
});
```

**Вывод при клике на кнопку**:
```
Child (цель)
```

**Пример с `stopImmediatePropagation`**:
```javascript
child.addEventListener('click', (event) => {
  console.log('Child (обработчик 1)');
  event.stopImmediatePropagation(); // Останавливаем все дальнейшие обработчики
});

child.addEventListener('click', () => {
  console.log('Child (обработчик 2)'); // Не сработает
});

parent.addEventListener('click', () => {
  console.log('Parent (всплытие)'); // Не сработает
});
```

**Вывод при клике на кнопку**:
```
Child (обработчик 1)
```

#### 3.2. Предотвращение стандартного поведения
Некоторые события имеют стандартное поведение браузера (например, переход по ссылке при клике на `<a>` или отправка формы при `submit`). Это поведение можно отменить с помощью `event.preventDefault()`.

**Пример**:

```html
<a href="https://example.com" id="link">Перейти</a>
<script>
  document.querySelector('#link').addEventListener('click', (event) => {
    event.preventDefault();
    console.log('Переход отменён');
  });
</script>
```

**Вывод при клике на ссылку**:
```
Переход отменён
```

---

### 4. Практические примеры

#### Пример 1: Делегирование событий с учётом фаз
Делегирование событий часто использует фазу всплытия для обработки событий на родительском элементе.

```html
<ul id="list">
  <li class="item">Элемент 1</li>
  <li class="item">Элемент 2</li>
</ul>
<script>
  const list = document.querySelector('#list');

  list.addEventListener('click', (event) => {
    if (event.target.classList.contains('item')) {
      console.log(`Клик на: ${event.target.textContent}, фаза: ${event.eventPhase}`);
    }
  });
</script>
```

**Вывод при клике на "Элемент 1"**:
```
Клик на: Элемент 1, фаза: 2
```
(Фаза 2 — это фаза цели, так как обработчик срабатывает на `<ul>`, но событие всплыло от `<li>`.)

#### Пример 2: Перехват события на фазе захвата
Фаза захвата полезна для перехвата событий до их обработки дочерними элементами.

```html
<div id="parent">
  <button id="child">Кликни меня</button>
</div>
<script>
  const parent = document.querySelector('#parent');

  parent.addEventListener(
    'click',
    (event) => {
      console.log('Перехват на родителе (захват)');
      event.stopPropagation(); // Останавливаем событие на фазе захвата
    },
    { capture: true }
  );

  document.querySelector('#child').addEventListener('click', () => {
    console.log('Клик на кнопке (цель)'); // Не сработает
  });
</script>
```

**Вывод при клике на кнопку**:
```
Перехват на родителе (захват)
```

---

### 5. Особенности жизненного цикла событий

1. **События, которые не всплывают**:
   - Некоторые события, такие как `focus`, `blur`, `scroll`, `mouseenter`, `mouseleave`, не проходят фазу всплытия. Однако их можно перехватывать на фазе захвата.
   - Для событий, которые должны всплывать, существуют аналоги (например, `focusin` и `focusout` вместо `focus` и `blur`).

2. **Свойство `event.eventPhase`**:
   - Позволяет определить, на какой фазе сработал обработчик:
     - `1`: Фаза захвата.
     - `2`: Фаза цели.
     - `3`: Фаза всплытия.
   **Пример**:

     ```javascript
     child.addEventListener('click', (event) => {
       console.log(`Фаза: ${event.eventPhase}`); // 2 (цель)
     });
     ```

3. **Производительность**:
   - Частое использование обработчиков на фазе захвата или всплытия может усложнить отладку. Используйте делегирование событий для оптимизации.
   - Для часто срабатывающих событий (`mousemove`, `scroll`) применяйте пассивные обработчики (`{ passive: true }`) или техники дебouncing/throttling.

4. **Кроссбраузерность**:
   - Жизненный цикл событий (захват, цель, всплытие) стандартизирован и поддерживается всеми современными браузерами (Chrome, Firefox, Safari, Edge).
   - В старых браузерах (например, IE8) поддержка ограничена, особенно для методов вроде `addEventListener`. Используйте полифиллы или альтернативные подходы (например, свойства `onclick`).

5. **Делегирование событий**:
   - Делегирование событий использует фазу всплытия для обработки событий на родительском элементе, что особенно полезно для динамически добавленных элементов.

---

### Итог:

Жизненный цикл событий DOM состоит из трёх фаз:
- **Захват**: Событие движется от `document` к целевому элементу; обработчики регистрируются с `{ capture: true }`.
- **Цель**: Событие обрабатывается на целевом элементе.
- **Всплытие**: Событие движется от цели к `document` и `window`; это поведение по умолчанию.

Вы можете управлять жизненным циклом с помощью:
- `event.stopPropagation()` — для остановки распространения события.
- `event.stopImmediatePropagation()` — для полной остановки обработки.
- `event.preventDefault()` — для отмены стандартного поведения браузера.

Примеры выше демонстрируют, как использовать эти фазы и управлять событиями. 

Полная документация по событиям доступна на [MDN Web Docs: Event reference](https://developer.mozilla.org/en-US/docs/Web/Events).